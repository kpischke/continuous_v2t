# for CPU only
pip install omegaconf torch==2.8.0 torchaudio==2.8.0 torchvision==0.23.0


# for GPU only
pip install omegaconf torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu121


You diagnosed it correctly: you now have a **version mismatch**.

* `whisperx 3.7.4` requires **torch ~= 2.8.0** and **torchaudio ~= 2.8.0**
* your command forced **torch/torchaudio 2.5.1+cu121**, which pip happily installed from the CUDA 12.1 index
* result: WhisperX is now incompatible and may fail at runtime.

This happens because the CUDA index you used provides a specific Torch stack (here 2.5.1) and pip downgraded you to match it.

## What you should do now (clean fix)

### Step 1 — Put Torch back to the version WhisperX wants (2.8.0)

You have two workable strategies:

---

# Strategy A (recommended): Use the **default PyPI** torch 2.8.0 stack (likely CPU or your current default build)

1. In your venv, uninstall the downgraded torch stack:

```powershell
cd C:\Users\kh-ab\Documents\GitHub\continuous_v2t
.venv\Scripts\activate
pip uninstall -y torch torchaudio torchvision sympy
```

2. Reinstall Torch **without** the CUDA index:

```powershell
pip install torch==2.8.0 torchaudio==2.8.0 torchvision==0.23.0
```

3. Verify versions:

```powershell
python -c "import torch, torchaudio, torchvision; print(torch.__version__); print(torchaudio.__version__); print(torchvision.__version__)"
python -c "import whisperx; print('whisperx ok')"
```

If that succeeds, you’re back in a consistent state.

**Note:** This might install CPU builds depending on how pip resolves on your machine. That’s fine for functional testing; GPU acceleration can come later once everything runs.

---

# Strategy B (GPU-focused): Install a **Torch 2.8.0 CUDA build** that matches your system

This is feasible, but the correct index URL depends on which CUDA builds PyTorch provides for **2.8.0** on Windows at the moment. The `cu121` index you used clearly served **2.5.1**, not 2.8.0.

Instead of guessing and causing another downgrade, do this:

1. Remove current torch stack:

```powershell
pip uninstall -y torch torchaudio torchvision sympy
```

2. Install the **WhisperX-compatible** versions first (CPU) so you can proceed immediately:

```powershell
pip install torch==2.8.0 torchaudio==2.8.0 torchvision==0.23.0
```

3. Only after WhisperX works, we can switch to GPU by selecting the correct CUDA wheel source for torch 2.8.0 (which requires checking what PyTorch offers for your CUDA runtime/driver). If you paste:

* your GPU model (`nvidia-smi` output) and
* your driver version,
  I can give you the exact GPU install command with the right index.

---

## Why you saw `torch 2.8.0` initially

Your environment previously had `torch 2.8.0` already installed (probably from a prior install via pip). That was actually good because it matches WhisperX. The CUDA index command replaced it with 2.5.1.

---

## Immediate action I recommend

Run Strategy A now to get unstuck quickly:

```powershell
cd C:\Users\kh-ab\Documents\GitHub\continuous_v2t
.venv\Scripts\activate
pip uninstall -y torch torchaudio torchvision sympy
pip install torch==2.8.0 torchaudio==2.8.0 torchvision==0.23.0
python -c "import whisperx, torch, torchaudio; print('OK', torch.__version__, torchaudio.__version__)"
```

If that prints OK, you can proceed with transcribing your test audio in the GUI.

---

## Optional: keep your project reproducible

Once you’re stable, I strongly recommend pinning these in `requirements.txt` (or a lock file), e.g.:

```text
whisperx==3.7.4
torch==2.8.0
torchaudio==2.8.0
torchvision==0.23.0
```

But do the repair first.

If you paste the output of:

```powershell
python -c "import torch; print(torch.__version__)"
```

after the reinstall, I’ll confirm you’re back on the correct stack.
